---
title: "Project proposal"
author: "Mr. Palmer's Penguins"
output: github_document
---

```{r load-packages-and-data, message = FALSE}
library(tidyverse)
library(lubridate)

# load data from tidytuesday site and write to csv in data folder
readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-07-27/olympics.csv') %>%
  write_csv(file = "/home/guest/project-01/data/olympics_data.csv")

```



## Sarab

## Drew


This dataset was accessed on Kaggle.com and includes data scraped in May 2018 from Sports Reference/OlympStats, sports statistics sites, by Randi Griffin, a Senior Data Scientist at Boston Consulting Group. 

The set, which includes 15 variables and 271,116 observations, provides insight into the athletes that competed in and results of the Olympic games from Athens 1896 to Rio 2016. Each observation includes information about an athlete on a per event basis. Therefore, if an athlete competes in multiple different athletic events, there will be multiple observations with each reflecting an individual event. Each observation details medal results, the athlete's background (age, sex, height, weight, team, etc.), and context about the event (where and when it was held, season, etc.).

The full list of variables are included here and described below:

```{r}
olympics <- read_csv("/home/guest/project-01/data/olympics_data.csv")
glimpse(olympics)
```

`ID` - This is a number assigned uniquely to each athlete.
A unique number associated with each athlete

`Name` - The name of the athlete competing.

`Sex` - Indicated whether the athlete is Male (M) or Female (F)

`Age` - The age of the athlete in years.

`Height` - The height of the athlete in centimeters.

`Weight` - The weight of the athlete in kilograms.

`Team` - The team (country in most cases) the athlete represents.

`NOC` - The 3-letter National Olympic Committee associated wit each team (country in most cases)

`Games` - The year (1896-2016) and season (Summer or Winter) in which the event took place. This is a character combination of `Year` and `Season`. It is important to note that the Summer and Winter games currently alternate every two years, but used to take place in the same year.

`Year` - The year (1896-2016) in which the event took place. 
`Season` - The season (Summer or Winter) in which the event took place.

`City` - The city in which the Olympic games for that year/season were hosted.

`Sport` - The sport the athlete is competing in.

`Event` - The event the athlete is competing in.

`Medal` - Indicates whether a Gold, Silver, or Bronze medal was one. Responses can also take the form NA if no medal was won or there is incomplete information.

We chose this dataset


The reason why you chose this dataset.

We chose this dataset because we think it can provide a lot of good insights into some of the trends at the Olympics over the past century as well as provide strong opportunities for our group to develop our visualization capabilities. 

The Olympics have always been a special global event. Countries from around the world come together to compete in a range of events. This share commitment to uniting the global community has time and time allowed ath
Ahtletes =  what makes them successful
Country information
Historical information about events
Outcomes

Evan: These data offer many avenues to explore when analyzing, such as medalwinning success on an athlete-level scale, on a country-level scale, for a particular sport over time, etc. Complementing this variety of potential analysis paradigms is the mixture of variable types. Common variable types of categorical, ordinal, time-series, and ratio are well represented in the data. This also affords us the opportunity to calculate new variables, such as converting the medal variable into a logical medal winner or non-medal winner.

Diversity of information (categorical and numeric =  good for analysis, opportunities to recode some of the existing variables

* Just finished the olympics
* Bringing together the global community, often reflective of broader social, cultural, and economic happenings in our world
* 

Evan: Finally, aside from the properties of the data itself, we chose to analyze data from the Olympic games due to the recency of the 2020 Tokyo Games and the role of the Games in reflecting the global culture of a time period. Historic events like the 1980 Moscow Games that were boycotted by the US and many other countries, the Games that were cancelled during the World Wars, and the modern advent of professional superstar Olympians all potentially provide insights into the story told by the data.





The two questions you want to answer.

A plan for answering each of the questions including the variables involved, variables to be created (if any), external data to be merged in (if any).

## Lilly

ideas: 
-relationship between GDP etc
-which olympics do athletes do best in (i.e. when they participate in multiple, typical peak performance?)

```{r}
olympics %>%
  distinct(id, games) %>%
  group_by(id) %>%
  count() %>%
  arrange(desc(n))

olympics_score <- olympics %>%
  mutate(medal = case_when(
    medal == "Gold" ~ 3,
    medal == "Silver" ~ 2,
    medal == "Bronze" ~ 1,
    TRUE ~ 0),
    date = ifelse(season == "Winter", paste0(year, "-02-01"), paste0(year, "-07-01")),
    date = ymd(date))

olympics_wider <- olympics_score %>%
  group_by(id, date, medal) %>%
  summarize(medals = sum(medal)) %>%
  select(-medal)

oly_numb <- olympics_wider %>%
  # number rows within each id to allow for pivoting
  group_by(id) %>%
  mutate(index = row_number()) %>%
  ungroup()
         #event = paste0(date, ", ", medals))

# pivot dates for same id into new columns
oly_numb %>%
  select(id, index, medals) %>%
  tidyr::pivot_wider(names_from = index, values_from = medals) %>%
  colMeans(na.rm = TRUE) %>%
  round(digits = 2) %>%
  knitr::kable()

oly_numb %>%
  count(index)

ggplot(oly_numb, aes(x = index, y = medals, group = id)) +
  geom_line(alpha = 0.05)

oly_numb %>%
  filter(index > 5) %>%
  ggplot(aes(x = index, y = medals, group = id)) +
  geom_line(alpha = 0.1)
```

```{r}
popular_sports <- olympics %>%
  count(sport) %>%
  arrange(desc(n)) %>%
  head(7)

woo <- left_join(popular_sports, olympics, by = "sport")
```

```{r}
# which sports are the most common crossovers?
# does amt of crossovers differ by country
# heatmap of sports on x and y axis that ppl participate across 

multisport_competitors <- olympics %>%
  distinct(id, sport) %>%
  group_by(id) %>%
  count() %>%
  arrange(desc(n)) %>%
  filter(n > 1) %>%
  left_join(olympics, by = "id")

#multisport_competitors %>%
#  distinct(name, sport) %>%
#  pivot_wider(id_cols = "id", names_from = "sport", values_from = "sport") %>%
#  mutate_all(case_when(
#    str_detect(., "\\d") ~ .,
#    str_detect(., "\\w") ~ 1,
#    TRUE ~ 0))
```

```{r}
olympics_score %>%
  group_by(noc, date, medal) %>%
  summarize(score = sum(medal)) %>%
  ggplot(aes(x = date, y = score, group = noc)) +
  geom_line(alpha = .2)
```

## Dataset

A brief description of your dataset including its provenance, dimensions, etc. as well as the reason why you chose this dataset.

Make sure to load the data and use inline code for some of this information.

## Questions

The two questions you want to answer.

1.

## Analysis plan

A plan for answering each of the questions including the variables involved, variables to be created (if any), external data to be merged in (if any).


