---
title: Project title
author: by Team name
output: github_document
---

```{r load-packages, echo = FALSE}
# load packages here
library(tidyverse)
library(lubridate)
library(magrittr)
library(countrycode)
```

```{r load-data, echo = FALSE}
# load data here
olympics <- read_csv(file = paste0(here::here(), "/data/olympics_data.csv"))
noc_regions <- read_csv(file = paste0(here::here(), "/data/noc_regions.csv"))
Flags <- countrycode(Countries, 'country.name', 'unicode.symbol')
```

## Introduction

(1-2 paragraphs)
Brief introduction to the dataset.
You may repeat some of the information about the dataset provided in the introduction to the dataset on the TidyTuesday repository, paraphrasing on your own terms.
Imagine that your project is a standalone document and the grader has no prior knowledge of the dataset.

## Question 1 <- Update title to relate to the question you’re answering

### Introduction

(1-2 paragraphs)
Introduction to the question and what parts of the dataset are necessary to answer the question. Also discuss why you’re interested in this question.

### Approach

(1-2 paragraphs)
Describe what types of plots you are going to make to address your question.
For each plot, provide a clear explanation as to why this plot (e.g. boxplot, barplot, histogram, etc.) is best for providing the information you are asking about. 
The two plots should be of different types, and at least one of the two plots needs to use either color mapping or facets.

### Analysis

``` {r evan-from-9-16-meeting}
## Evan

# Get vector of sports to keep: ie. those that have at least 5 observations per gender
sports_to_keep <- olympics %>%
  group_by(sport, sex) %>%
  summarise(n_per_gender = n()) %>%
  filter(n_per_gender > 5) %>%
  summarise(genders_per_sport = n()) %>%
  filter(genders_per_sport == 2) %>%
  select(sport) %>%
  pull()

# Remove all observations from data frame except those from the desired sports we identified above. We also need to remove Croquet and Art Competitions, as those data do not have height or weight measurements.
olympics_evan <- olympics %>%
  filter(sport %in% sports_to_keep) %>%
  filter(!(sport %in% c("Croquet", "Art Competitions")))

# Also im just going to keep summer sports to try to reduce visual overload
#olympics_evan <- olympics_evan %>%
  #filter(season == "Summer")

# Create new needed variables
olympics_evan <- olympics_evan %>%
  mutate(medalwinner = if_else(is.na(medal), FALSE, TRUE),
         h_to_w = height / weight)

# Create plot to examine height to weight ratios and how they vary between sexes and medalwinners and non-medalwinners, and then comparing these trends across sports
ggplot(olympics_evan, mapping = aes(x = medalwinner, y = h_to_w)) +
  geom_boxplot(aes(color = sex)) +
  facet_wrap(vars(sport))

#TODOS: see what's going on with ice hockey (looks like only males, and only medalwinners) and figure skating (looks like only medalwinners, but both sexes are still represented.)

olympics %>%
  filter(sport == "Beach Volleyball" | sport == "Volleyball") %>%
  mutate(h_to_w = height / weight) %>%
  group_by(sex, year) %>%
  summarise(mean_h_to_w = mean(h_to_w, na.rm = TRUE),
            mean_height = mean(height, na.rm = TRUE),
            mean_weight = mean(weight, na.rm = TRUE)) %>%
  ggplot(mapping = aes(x = year, group = sex, linetype = sex)) +
    geom_line(aes(y = mean_h_to_w), color = "purple") +
    geom_line(aes(y = mean_height), color = "blue") +
    geom_line(aes(y = mean_weight), color = "green") +
    geom_vline(xintercept = c(1984, 1992), color = "red")

```

(2-3 code blocks, 2 figures, text/code comments as needed)
In this section, provide the code that generates your plots. Use scale functions to provide nice axis labels and guides.
You are welcome to use theme functions to customize the appearance of your plot, but you are not required to do so.
All plots must be made with ggplot2. Do not use base R or lattice plotting functions.

### Discussion

(1-3 paragraphs)
In the Discussion section, interpret the results of your analysis. Identify any trends revealed (or not revealed) by the plots.
Speculate about why the data looks the way it does.

## Question 2 <- Update title to relate to the question you’re answering

### Introduction

(1-2 paragraphs)
Introduction to the question and what parts of the dataset are necessary to answer the question. Also discuss why you’re interested in this question.

### Approach

(1-2 paragraphs)
Describe what types of plots you are going to make to address your question.
For each plot, provide a clear explanation as to why this plot (e.g. boxplot, barplot, histogram, etc.) is best for providing the information you are asking about. 
The two plots should be of different types, and at least one of the two plots needs to use either color mapping or facets.

### Analysis

(2-3 code blocks, 2 figures, text/code comments as needed)
In this section, provide the code that generates your plots. Use scale functions to provide nice axis labels and guides.
You are welcome to use theme functions to customize the appearance of your plot, but you are not required to do so.
All plots must be made with ggplot2. Do not use base R or lattice plotting functions.

```{r wrangling-medals}
# make appropriate date
olympics %<>%
  mutate(date = ifelse(season == "Winter", paste0(year, "-02-01"), paste0(year, "-07-01")),
         date = ymd(date),
         medal_winner = ifelse(is.na(medal), 0, 1),
         medal_score = case_when(
           medal == "Bronze" ~ 1,
           medal == "Silver" ~ 2,
           medal == "Gold" ~ 3,
           TRUE ~ 0))


```

Next, we will mutate `medal` from a categorical variable with 'Gold', 'Silver', 'Bronze', and NA as outcomes to either a numeric indicator (medal = 1 for any win and medal = 0 for no medal received) or a score that rewards the most points for Gold, then Silver, then Bronze. Through iterative visualization we will determine whether examining success only based on medal count or differentiating gold, silver, and bronze victories allows for a more meaningful display of trends. We will also later group the observations by region of National Olympic Committee, or `noc`, which reflects what we understand to be country identities today more accurately than `team` does. Merging in this [secondary dataset](https://www.kaggle.com/heesoo37/120-years-of-olympic-history-athletes-and-results?select=noc_regions.csv) provided with the athlete-event level data by Kaggle will allow us to expand our country labeling from three-letter NOC abbreviations to complete country names. Additionally, the dataframe in the package [countrycode](https://vincentarelbundock.github.io/countrycode/) links countries by their names in various formats to their unicode flag emojis. Merging this data in will assist us with our visualizations of this question.

After the above merging and necessary cleaning, we will group the data by `country`, `sport`, and `date` to compute a new variable called `medals_total` by taking the sum of either our medal-won indicator or our medal score assigned to differentiate gold, silver and bronze victories. These steps should allow us to begin an initial approach to visualization.

In our first visualization, we will plot `medals_total` on the y-axis and `date` on the x-axis with lines grouped by `country` and faceting by `sport`. We will select just a few sports of interest to compare and use selective color mapping for countries of interest and transparency to strongly highlight a few countries and make the remaining lines indistinguishable in the background. If this technique remains visually overwhelming after prototyping our plot, we will filter to select just a few countries of interest in each sport and color map only those.

### Discussion

(1-3 paragraphs)
In the Discussion section, interpret the results of your analysis. Identify any trends revealed (or not revealed) by the plots.
Speculate about why the data looks the way it does.

## Presentation

Our presentation can be found [here](presentation/presentation.html).

## Data 

Include a citation for your data here. 
See http://libraryguides.vu.edu.au/c.php?g=386501&p=4347840 for guidance on proper citation for datasets. 
If you got your data off the web, make sure to note the retrieval date.

## References

List any references here. You should, at a minimum, list your data source.
